{"ast":null,"code":"import\"antd/es/modal/style\";import _Modal from\"antd/es/modal\";import _regeneratorRuntime from\"/Users/stevenl/Desktop/Projects/Content-Management-System/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/stevenl/Desktop/Projects/Content-Management-System/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/stevenl/Desktop/Projects/Content-Management-System/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/stevenl/Desktop/Projects/Content-Management-System/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/stevenl/Desktop/Projects/Content-Management-System/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/stevenl/Desktop/Projects/Content-Management-System/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/stevenl/Desktop/Projects/Content-Management-System/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{withRouter}from'react-router-dom';import LinkButton from'../../components/link-button';import menuList from'../../config/menuConfig';import{reqWeather}from'../../api';import memoryUtils from'../../utils/memoryUtils';import storageUtils from'../../utils/storageUtils';import{formatDate}from'../../utils/dateUtils';import'./index.less';import{setInterval}from'timers';var Header=/*#__PURE__*/function(_Component){_inherits(Header,_Component);function Header(){var _getPrototypeOf2;var _this;_classCallCheck(this,Header);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Header)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={currentTime:formatDate(Date.now()),name:'',temp:'',icon:''};_this.getCurrentTime=function(){// get the current time per 1 second and then update the state of currentTime\n_this.intervalId=setInterval(function(){var currentTime=formatDate(Date.now());_this.setState({currentTime:currentTime});},1000);};_this.getWeather=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _ref2,name,temp,icon;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return reqWeather('Sydney');case 2:_ref2=_context.sent;name=_ref2.name;temp=_ref2.temp;icon=_ref2.icon;// update the state\n_this.setState({name:name,temp:temp,icon:icon});case 7:case\"end\":return _context.stop();}}},_callee);}));_this.getTitle=function(){// get the current path\nvar path=_this.props.location.pathname;var title;menuList.forEach(function(item){// the title of item of menulist is the title that should be display on the main page if the key of item totally equal to the current path\nif(item.key===path){title=item.title;}else if(item.children){// use the same login in children to find the key of item equal to path and then get the corresponding title\nitem.children.find(function(subItem){if(subItem.key===path){title=subItem.title;}});}});return title;};_this.logout=function(){_Modal.confirm({title:'Do you Want to logout?',onOk:function onOk(){// console.log('ok',this);\n// delete the data of user in localStorage\nstorageUtils.removeUser();memoryUtils.user={};// jump to the login page\n_this.props.history.replace('/login');}});};_this.convertKelvinToCelsius=function(temp){if(temp<0){return'below absolute zero (0 K)';}else{return temp-273.15;}};return _this;}_createClass(Header,[{key:\"componentDidMount\",value:function componentDidMount(){// get the current time\nthis.getCurrentTime();// get the current weather\nthis.getWeather();// get the Celsius\nthis.convertKelvinToCelsius();}// used to clear the timer before the component unload\n},{key:\"componentWillUnmount\",value:function componentWillUnmount(){// clear the timer\nclearInterval(this.intervalId);}},{key:\"render\",value:function render(){var _this$state=this.state,currentTime=_this$state.currentTime,name=_this$state.name,temp=_this$state.temp,icon=_this$state.icon;var iconUrl=\"http://openweathermap.org/img/wn/\".concat(icon,\"@2x.png\");var username=memoryUtils.user[0].username;var title=this.getTitle();return React.createElement(\"div\",{className:\"header\"},React.createElement(\"div\",{className:\"header-top\"},React.createElement(\"span\",null,\"Hello, \",username),React.createElement(LinkButton,{onClick:this.logout},\"Logout\")),React.createElement(\"div\",{className:\"header-bottom\"},React.createElement(\"div\",{className:\"header-bottom-left\"},title),React.createElement(\"div\",{className:\"header-bottom-right\"},React.createElement(\"span\",null,currentTime),React.createElement(\"span\",null,name),React.createElement(\"img\",{src:iconUrl,alt:\"weather\"}),React.createElement(\"span\",null,this.convertKelvinToCelsius(temp).toFixed(1)+\"\\xB0C\"))));}}]);return Header;}(Component);export default withRouter(Header);","map":{"version":3,"sources":["/Users/stevenl/Desktop/Projects/Content-Management-System/client/src/components/header/index.js"],"names":["React","Component","withRouter","LinkButton","menuList","reqWeather","memoryUtils","storageUtils","formatDate","setInterval","Header","state","currentTime","Date","now","name","temp","icon","getCurrentTime","intervalId","setState","getWeather","getTitle","path","props","location","pathname","title","forEach","item","key","children","find","subItem","logout","confirm","onOk","removeUser","user","history","replace","convertKelvinToCelsius","clearInterval","iconUrl","username","toFixed"],"mappings":"8kCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,UAAT,KAA2B,kBAA3B,CAEA,MAAOC,CAAAA,UAAP,KAAuB,8BAAvB,CAEA,MAAOC,CAAAA,QAAP,KAAqB,yBAArB,CACA,OAASC,UAAT,KAA2B,WAA3B,CACA,MAAOC,CAAAA,WAAP,KAAwB,yBAAxB,CACA,MAAOC,CAAAA,YAAP,KAAyB,0BAAzB,CACA,OAASC,UAAT,KAA2B,uBAA3B,CACA,MAAO,cAAP,CACA,OAASC,WAAT,KAA4B,QAA5B,C,GAEMC,CAAAA,M,+XAEFC,K,CAAQ,CACJC,WAAW,CAAEJ,UAAU,CAACK,IAAI,CAACC,GAAL,EAAD,CADnB,CAEJC,IAAI,CAAE,EAFF,CAGJC,IAAI,CAAE,EAHF,CAIJC,IAAI,CAAE,EAJF,C,OAORC,c,CAAiB,UAAM,CACnB;AACA,MAAKC,UAAL,CAAkBV,WAAW,CAAC,UAAM,CAChC,GAAMG,CAAAA,WAAW,CAAGJ,UAAU,CAACK,IAAI,CAACC,GAAL,EAAD,CAA9B,CACA,MAAKM,QAAL,CAAc,CAACR,WAAW,CAAXA,WAAD,CAAd,EACH,CAH4B,CAG1B,IAH0B,CAA7B,CAIH,C,OAEDS,U,sEAAa,kLAE0BhB,CAAAA,UAAU,CAAC,QAAD,CAFpC,4BAEDU,IAFC,OAEDA,IAFC,CAEKC,IAFL,OAEKA,IAFL,CAEWC,IAFX,OAEWA,IAFX,CAIT;AACA,MAAKG,QAAL,CAAc,CAAEL,IAAI,CAAJA,IAAF,CAAQC,IAAI,CAAJA,IAAR,CAAcC,IAAI,CAAJA,IAAd,CAAd,EALS,sD,SAQbK,Q,CAAW,UAAM,CACb;AACA,GAAMC,CAAAA,IAAI,CAAG,MAAKC,KAAL,CAAWC,QAAX,CAAoBC,QAAjC,CACA,GAAIC,CAAAA,KAAJ,CACAvB,QAAQ,CAACwB,OAAT,CAAiB,SAAAC,IAAI,CAAI,CACrB;AACA,GAAGA,IAAI,CAACC,GAAL,GAAaP,IAAhB,CAAsB,CAClBI,KAAK,CAAGE,IAAI,CAACF,KAAb,CACH,CAFD,IAEO,IAAGE,IAAI,CAACE,QAAR,CAAkB,CACrB;AACAF,IAAI,CAACE,QAAL,CAAcC,IAAd,CAAmB,SAAAC,OAAO,CAAI,CAC1B,GAAGA,OAAO,CAACH,GAAR,GAAgBP,IAAnB,CAAyB,CACrBI,KAAK,CAAGM,OAAO,CAACN,KAAhB,CACH,CACJ,CAJD,EAKH,CACJ,CAZD,EAaA,MAAOA,CAAAA,KAAP,CACH,C,OAEDO,M,CAAS,UAAM,CACZ,OAAMC,OAAN,CAAc,CACbR,KAAK,CAAE,wBADM,CAEbS,IAAI,CAAE,eAAM,CACV;AACA;AACA7B,YAAY,CAAC8B,UAAb,GACA/B,WAAW,CAACgC,IAAZ,CAAmB,EAAnB,CAEA;AACA,MAAKd,KAAL,CAAWe,OAAX,CAAmBC,OAAnB,CAA2B,QAA3B,EACD,CAVY,CAAd,EAYF,C,OAEDC,sB,CAAyB,SAACzB,IAAD,CAAU,CAC/B,GAAIA,IAAI,CAAI,CAAZ,CAAgB,CACZ,MAAO,2BAAP,CACH,CAFD,IAEO,CACH,MAAQA,CAAAA,IAAI,CAAC,MAAb,CACH,CACJ,C,+FAEmB,CAChB;AACA,KAAKE,cAAL,GAEA;AACA,KAAKG,UAAL,GAEA;AACA,KAAKoB,sBAAL,GACH,CAED;mEACuB,CACnB;AACAC,aAAa,CAAC,KAAKvB,UAAN,CAAb,CACH,C,uCAEQ,iBACqC,KAAKR,KAD1C,CACGC,WADH,aACGA,WADH,CACgBG,IADhB,aACgBA,IADhB,CACsBC,IADtB,aACsBA,IADtB,CAC4BC,IAD5B,aAC4BA,IAD5B,CAEL,GAAM0B,CAAAA,OAAO,4CAAuC1B,IAAvC,WAAb,CACA,GAAM2B,CAAAA,QAAQ,CAAGtC,WAAW,CAACgC,IAAZ,CAAiB,CAAjB,EAAoBM,QAArC,CACA,GAAMjB,CAAAA,KAAK,CAAG,KAAKL,QAAL,EAAd,CAEA,MACI,4BAAK,SAAS,CAAC,QAAf,EACI,2BAAK,SAAS,CAAC,YAAf,EACI,0CAAcsB,QAAd,CADJ,CAEI,oBAAC,UAAD,EAAY,OAAO,CAAE,KAAKV,MAA1B,WAFJ,CADJ,CAKI,2BAAK,SAAS,CAAC,eAAf,EACI,2BAAK,SAAS,CAAC,oBAAf,EAAqCP,KAArC,CADJ,CAEI,2BAAK,SAAS,CAAC,qBAAf,EACI,gCAAOf,WAAP,CADJ,CAEI,gCAAOG,IAAP,CAFJ,CAGI,2BAAK,GAAG,CAAE4B,OAAV,CAAmB,GAAG,CAAC,SAAvB,EAHJ,CAII,gCAAO,KAAKF,sBAAL,CAA4BzB,IAA5B,EAAkC6B,OAAlC,CAA0C,CAA1C,SAAP,CAJJ,CAFJ,CALJ,CADJ,CAiBH,C,oBA5GgB5C,S,EA+GrB,cAAeC,CAAAA,UAAU,CAACQ,MAAD,CAAzB","sourcesContent":["import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\n\nimport LinkButton from '../../components/link-button';\nimport { Modal } from 'antd';\nimport menuList from '../../config/menuConfig';\nimport { reqWeather } from '../../api';\nimport memoryUtils from '../../utils/memoryUtils';\nimport storageUtils from '../../utils/storageUtils';\nimport { formatDate } from '../../utils/dateUtils';\nimport './index.less';\nimport { setInterval } from 'timers';\n\nclass Header extends Component {\n    \n    state = {\n        currentTime: formatDate(Date.now()),\n        name: '',\n        temp: '',\n        icon: '',\n    }\n\n    getCurrentTime = () => {\n        // get the current time per 1 second and then update the state of currentTime\n        this.intervalId = setInterval(() => {\n            const currentTime = formatDate(Date.now());\n            this.setState({currentTime});\n        }, 1000);\n    }\n\n    getWeather = async () => {\n        // get the weather data by invoking the asynchronus API\n        const { name, temp, icon } = await reqWeather('Sydney');\n\n        // update the state\n        this.setState({ name, temp, icon });\n    }\n\n    getTitle = () => {\n        // get the current path\n        const path = this.props.location.pathname;\n        let title;\n        menuList.forEach(item => {\n            // the title of item of menulist is the title that should be display on the main page if the key of item totally equal to the current path\n            if(item.key === path) {\n                title = item.title;\n            } else if(item.children) {\n                // use the same login in children to find the key of item equal to path and then get the corresponding title\n                item.children.find(subItem => {\n                    if(subItem.key === path) {\n                        title = subItem.title;\n                    }\n                });\n            }\n        });\n        return title;\n    }\n\n    logout = () => {\n       Modal.confirm({\n        title: 'Do you Want to logout?',\n        onOk: () => {\n          // console.log('ok',this);\n          // delete the data of user in localStorage\n          storageUtils.removeUser();\n          memoryUtils.user = {};\n\n          // jump to the login page\n          this.props.history.replace('/login');\n        }\n      }); \n    }\n\n    convertKelvinToCelsius = (temp) => {\n        if (temp < (0)) {\n            return 'below absolute zero (0 K)';\n        } else {\n            return (temp-273.15);\n        }\n    }\n\n    componentDidMount() {\n        // get the current time\n        this.getCurrentTime();\n\n        // get the current weather\n        this.getWeather();\n\n        // get the Celsius\n        this.convertKelvinToCelsius();\n    }\n\n    // used to clear the timer before the component unload\n    componentWillUnmount() {\n        // clear the timer\n        clearInterval(this.intervalId);\n    }\n\n    render() {\n        const { currentTime, name, temp, icon } = this.state;\n        const iconUrl = `http://openweathermap.org/img/wn/${icon}@2x.png`;\n        const username = memoryUtils.user[0].username;\n        const title = this.getTitle();\n\n        return (\n            <div className=\"header\">\n                <div className=\"header-top\">\n                    <span>Hello, {username}</span>\n                    <LinkButton onClick={this.logout}>Logout</LinkButton>\n                </div>\n                <div className=\"header-bottom\">\n                    <div className=\"header-bottom-left\">{title}</div>\n                    <div className=\"header-bottom-right\">\n                        <span>{currentTime}</span>\n                        <span>{name}</span>\n                        <img src={iconUrl} alt=\"weather\"/>\n                        <span>{this.convertKelvinToCelsius(temp).toFixed(1)+`°C`}</span>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default withRouter(Header);"]},"metadata":{},"sourceType":"module"}